# 自動機能選択システム

## 🎯 概要

ClaudeFlowの自動機能選択システムは、アプリ作成時の対話的な質問を省略し、行数制限内で最適な機能セットを自動的に選択します。

## 🚀 動作

### 従来の対話的選択（無効時）
```
💫 アニメーション (150行) - 視覚的効果とアニメーション
   追加後: 650行 / 800行
   この機能を追加しますか？ (y/N): _
```

### 自動選択（有効時）
```
🤖 自動機能選択を実行中...
📋 基本機能を追加中...
  ✓ 基本UI (100行) - 必須のユーザーインターフェース
  ✓ コア機能 (250行) - アプリの中核となる機能
  ✓ データ処理 (100行) - 基本的なデータ操作
  ✓ エラーハンドリング (50行) - エラー処理と例外対応

🚀 拡張機能を自動選択中...
  ✓ 高度なUI (200行) - リッチなユーザーインターフェース [自動追加]
  ✓ アニメーション (150行) - 視覚的効果とアニメーション [自動追加]
  ⏭️ API連携 (400行) - 制限超過のためスキップ

✅ 自動機能選択が完了しました
```

## 🔧 設定方法

### 環境変数
```bash
# 自動選択を有効化（デフォルト）
export CLAUDEFLOW_AUTO_FEATURES=true

# 自動選択を無効化（従来の対話的選択）
export CLAUDEFLOW_AUTO_FEATURES=false
```

### 使用例
```bash
# 自動選択でアプリを作成
./ultra-light.sh
# → 質問なしで最適な機能が選択される

# 対話的選択でアプリを作成
CLAUDEFLOW_AUTO_FEATURES=false ./ultra-light.sh
# → 各機能について質問される
```

## 📊 選択アルゴリズム

### 1. 基本機能（必須）
以下の機能は常に自動的に追加されます：
- **基本UI** - 必須のユーザーインターフェース
- **コア機能** - アプリの中核となる機能
- **データ処理** - 基本的なデータ操作
- **エラーハンドリング** - エラー処理と例外対応

### 2. 拡張機能（制限内で追加）
優先度順に以下の機能を追加試行：
1. **高度なUI** - リッチなユーザーインターフェース
2. **アニメーション** - 視覚的効果とアニメーション
3. **データ永続化** - データの保存と読み込み
4. **パフォーマンス最適化** - 速度と効率の改善
5. **API連携** - 外部APIとの連携
6. **マルチユーザー** - 複数ユーザー対応

### 3. 制限チェック
- 各機能追加前に行数制限をチェック
- 制限を超える場合は自動的にスキップ
- 最大限の機能を実装可能な組み合わせを選択

## 📁 出力ファイル

### codefit_feature_selection.md
```markdown
# CodeFit Design 機能選択結果

## プロジェクト情報
- **アプリ名**: 魚釣りゲーム
- **行数制限**: 800行
- **見積もり総行数**: 750行
- **使用率**: 93%
- **選択日時**: 2025-01-16 15:30:00

## 選択された機能
| 機能名 | 見積もり行数 | 優先度 |
|--------|-------------|--------|
| 基本UI | 100行 | 高 |
| コア機能 | 250行 | 高 |
| データ処理 | 100行 | 高 |
| エラーハンドリング | 50行 | 高 |
| 高度なUI | 200行 | 中 |
| アニメーション | 150行 | 中 |
```

### features.json
```json
{
  "app_name": "魚釣りゲーム",
  "generated_at": "2025-01-16T15:30:00Z",
  "auto_selected": true,
  "features": [
    {"name": "基本UI", "estimated_lines": 100, "priority": "高"},
    {"name": "コア機能", "estimated_lines": 250, "priority": "高"},
    {"name": "データ処理", "estimated_lines": 100, "priority": "高"},
    {"name": "エラーハンドリング", "estimated_lines": 50, "priority": "高"},
    {"name": "高度なUI", "estimated_lines": 200, "priority": "中"},
    {"name": "アニメーション", "estimated_lines": 150, "priority": "中"}
  ]
}
```

## 🎨 メリット

### 1. 開発速度の向上
- 対話的な質問への回答が不要
- すぐにアプリ生成を開始
- 5分でアプリが完成

### 2. 最適な機能選択
- 行数制限を考慮した自動判定
- 優先度に基づく機能追加
- バランスの取れた実装

### 3. 一貫性の確保
- 常に同じアルゴリズムで選択
- 予測可能な結果
- 再現性の高い開発

## ⚠️ 注意事項

### カスタマイズが必要な場合
特定の機能構成が必要な場合は、対話的選択モードを使用してください：
```bash
export CLAUDEFLOW_AUTO_FEATURES=false
```

### 行数制限の調整
デフォルトの行数制限を変更することで、より多くの機能を含められます：
```bash
export CLAUDEFLOW_MAX_LINES=1500  # 軽量モード
export CLAUDEFLOW_MAX_LINES=2000  # 標準モード
```

## 🔍 トラブルシューティング

### 期待する機能が含まれない場合
1. 行数制限を確認
2. 対話的選択モードで手動選択
3. features.jsonを直接編集

### 自動選択が動作しない場合
```bash
# 環境変数を確認
echo $CLAUDEFLOW_AUTO_FEATURES

# 明示的に有効化
export CLAUDEFLOW_AUTO_FEATURES=true
```

---

**実装日**: 2025-01-16  
**実装者**: Claude Code  
**バージョン**: 1.0